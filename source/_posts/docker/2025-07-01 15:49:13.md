---
title: Docker ç”¨æ³•
date: 2025-07-01 15:49:13
tags:
  - Docker ç”¨æ³•
categories:
  - Docker
---

# Docker åŸºç¡€ç”¨æ³•

### æ‹‰å–é•œåƒ

**é…ç½®åŠ é€Ÿå™¨**

```bash
å¯¹äºä½¿ç”¨ upstart çš„ç³»ç»Ÿè€Œè¨€ï¼Œç¼–è¾‘ /etc/default/docker æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­çš„ DOCKER_OPTS ä¸­é…ç½®åŠ é€Ÿå™¨åœ°å€ï¼š
DOCKER_OPTS="--registry-mirror=https://registry.docker-cn.com"

service docker restart

Ubuntu16.04+ã€Debian8+ã€CentOS7
å¯¹äºä½¿ç”¨ systemd çš„ç³»ç»Ÿï¼Œè¯·åœ¨ /etc/docker/daemon.json ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨è¯·æ–°å»ºè¯¥æ–‡ä»¶ï¼‰ï¼š
{"registry-mirrors":["https://reg-mirror.qiniu.com/"]}

systemctl daemon-reload
systemctl restart docker
```

### åŸºç¡€å‘½ä»¤

```bash
# æŸ¥çœ‹æœ¬åœ°æœ‰æ•ˆé•œåƒ
docker images
docker image list
# ä¸‹è½½é•œåƒä¸åŒç‰ˆæœ¬ï¼ˆä¸è·Ÿç‰ˆæœ¬å·å°±æ˜¯é»˜è®¤æœ€æ–°ç‰ˆæœ¬ï¼‰
docker pull ubuntu:11
docker pull ubuntu:12.04
docker pull centos:7
# è¿è¡Œ
docker run  -it  --name å®¹å™¨å imagename  /bin/bash
docker run -d åå°
docker search centos * è¿™ç§æ–¹æ³•åªèƒ½ç”¨äºå®˜æ–¹é•œåƒåº“ æœç´¢åŸºäº centos æ“ä½œç³»ç»Ÿçš„é•œåƒ
# æ‹‰å–é•œåƒ
docker pull centos  æ³¨ï¼šæ²¡æœ‰åŠ registryï¼Œé»˜è®¤æ˜¯ä»docker.io/dockerhubä¸‹è½½çš„
docker pull daocloud.io/library/tomcat:7
docker pull daocloud.io/library/centos:6
# æŸ¥çœ‹é•œåƒè¯¦ç»†
docker inspect é•œåƒid/é•œåƒåç§°
# åˆ é™¤é•œåƒ
docker rmi daocloud.io/library/mysql
docker rmi 81debc
# åˆ é™¤å¤šä¸ªï¼Œç”¨ç©ºæ ¼éš”å¼€
æˆ–è€… docker image rm é•œåƒåæˆ–è€…é•œåƒid
# ä¹‹æŸ¥çœ‹æ‰€æœ‰é•œåƒid
docker images -q
# åˆ é™¤æ‰€æœ‰é•œåƒ
docker rmi $(docker images -q)
docker rmi `docker images -q`
docker    create    --name  å®¹å™¨å        é•œåƒå            #åˆ›å»ºæ–°å®¹å™¨ä½†ä¸å¯åŠ¨
docker    start    å®¹å™¨å/å®¹å™¨ID                       #è¿è¡Œå®¹å™¨
docker    restart    å®¹å™¨å/å®¹å™¨ID                     #é‡å¯å®¹å™¨
docker    stop    å®¹å™¨å/å®¹å™¨ID                       #åœæ­¢å®¹å™¨
docker    kill    å®¹å™¨å/å®¹å™¨ID                       #å¼ºåˆ¶åœæ­¢å®¹å™¨
docker     stop/kill    $(docker ps -q)             #åœæ­¢æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨
docker    pause    å®¹å™¨å/å®¹å™¨ID                       #æš‚åœå®¹å™¨
docker    nopause    å®¹å™¨å/å®¹å™¨ID                     #æ¢å¤å®¹å™¨çš„è¿è¡Œ
docker    rename    æ—§å®¹å™¨å    æ–°å®¹å™¨å               #ä¿®æ”¹å®¹å™¨å
docker    stats    å®¹å™¨å/å®¹å™¨ID                       #å®æ—¶æ˜¾ç¤ºå®¹å™¨èµ„æºä½¿ç”¨ç»Ÿè®¡ä¿¡æ¯
docker    inspect    å®¹å™¨id/å®¹å™¨å                     #æŸ¥çœ‹æœ¬åœ°å®¹å™¨è¯¦ç»†ä¿¡æ¯
docker    top        å®¹å™¨id/å®¹å™¨å                       #æŸ¥çœ‹å®¹å™¨å†…è¿›ç¨‹è¯¦ç»†ä¿¡æ¯
docker    cp    -a    å®¹å™¨åï¼šè·¯å¾„    æœ¬åœ°å­˜æ”¾ä½ç½®          #ä»å®¹å™¨æ‹·è´åˆ°æœ¬æœº
docker    cp    -a    æœ¬åœ°æ–‡ä»¶è·¯å¾„    å®¹å™¨åï¼šè·¯å¾„          #ä»æœ¬æœºæ‹·è´åˆ°å®¹å™¨
docker image save <image_name>:<tag> >/to/path/<image_name>.tar.gz   #å¯¼å‡ºé•œåƒ
docker image load -i /to/path/<image_name>.tar.gz   #å¯¼å…¥é•œåƒ
docker export my_container > container.tar expo    # å¯¼å‡ºå®¹å™¨
docker import  my_v3.tar nginx/nginx:v4   # å¯¼å…¥å®¹å™¨
docker update --restart=always <å®¹å™¨åæˆ–ID>    # ä¿®æ”¹å·²æœ‰å®¹å™¨çš„é‡å¯ç­–ç•¥
docker ps -aqf "ancestor=mysql:8.0" # æ‰¾å‡ºé•œåƒæ˜¯ mysql:8.0 çš„å®¹å™¨
docker ps -aqf "status=exited" # æ‰¾å‡ºå·²é€€å‡ºçš„å®¹å™¨
docker ps -aqf "name=^mysql8" # æ‰¾å‡ºåå­—ä»¥ mysql8 å¼€å¤´çš„å®¹å™¨
```

```bash
docker run -d \
  --name mysql8 \
  -e MYSQL_ROOT_PASSWORD=song@123 \
  -p 3306:3306 \
  mysql:8.0
```

- -dï¼šåå°è¿è¡Œå®¹å™¨ã€‚

- --name mysql8ï¼šå®¹å™¨åä¸º mysql8ã€‚

- -e MYSQL_ROOT_PASSWORD=song@123ï¼šè®¾ç½® root ç”¨æˆ·å¯†ç ã€‚

- -p 3306:3306ï¼šå°†å®¿ä¸»æœº 3306 ç«¯å£æ˜ å°„åˆ°å®¹å™¨å†…çš„ 3306 ç«¯å£ã€‚
- -v <ä¸»æœºè·¯å¾„>:<å®¹å™¨è·¯å¾„>

### --restart ğŸ†š æ€»ç»“å¯¹æ¯”

```bash
docker inspect -f '{{.HostConfig.RestartPolicy.Name}}' <å®¹å™¨å\id>
```

|      ç­–ç•¥      |                     è¯´æ˜                     | ç³»ç»Ÿé‡å¯å | å¼‚å¸¸é€€å‡º | æ­£å¸¸é€€å‡º | æ‰‹åŠ¨åœæ­¢å |
| :------------: | :------------------------------------------: | :--------: | :------: | :------: | :--------: |
|   noï¼ˆé»˜è®¤ï¼‰   |                  ä¸è‡ªåŠ¨é‡å¯                  |     å¦     |    å¦    |    å¦    |    N/A     |
|     always     |                 æ€»æ˜¯è‡ªåŠ¨é‡å¯                 |     æ˜¯     |    æ˜¯    |    æ˜¯    |   ä¼šé‡å¯   |
| on-failure[:N] |          é 0 é€€å‡ºæ‰é‡å¯ï¼Œæœ€å¤š N æ¬¡          |     å¦     |    æ˜¯    |    å¦    |     å¦     |
| unless-stopped | æ€»æ˜¯è‡ªåŠ¨é‡å¯ï¼Œä½†å¦‚æœä½ æ‰‹åŠ¨åœè¿‡å®ƒï¼Œå°±ä¸å†å¯åŠ¨ |     æ˜¯     |    æ˜¯    |    æ˜¯    |  ä¸ä¼šé‡å¯  |

```bash
docker exec -i mysql8 mysql -uroot -pYOUR_PASSWORD < /backup.sql # ç›´æ¥å¯¼å…¥ä¹‹æ­Œæ•°æ®åº“
```
